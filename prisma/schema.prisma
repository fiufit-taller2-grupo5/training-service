generator client {
  provider        = "prisma-client-js"
  binaryTargets   = ["native"]
  previewFeatures = ["multiSchema"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
  schemas  = ["training-service"]
}

model TrainingPlan {
  id                       Int                        @id @default(autoincrement())
  title                    String
  description              String?
  multimedia               Multimedia[]
  state                    String
  difficulty               Int?
  type                     String
  trainerId                Int?
  planReviews              PlanReview[]
  trainingTypeId           Int?
  UserFavoriteTrainingPlan UserFavoriteTrainingPlan[]

  @@schema("training-service")
}

model Multimedia {
  id             Int          @id @default(autoincrement())
  fileUrl        String
  type           String
  trainingPlan   TrainingPlan @relation(fields: [trainingPlanId], references: [id])
  trainingPlanId Int

  @@schema("training-service")
}

// its a N-N relationship
model UserFavoriteTrainingPlan {
  userId         Int
  trainingPlanId Int
  trainingPlan   TrainingPlan @relation(fields: [trainingPlanId], references: [id])

  @@id([userId, trainingPlanId])
  @@schema("training-service")
}

model PlanReview {
  id             Int          @id @default(autoincrement())
  userId         Int
  comment        String?
  score          Int
  trainingPlan   TrainingPlan @relation(fields: [trainingPlanId], references: [id])
  trainingPlanId Int

  @@schema("training-service")
}
